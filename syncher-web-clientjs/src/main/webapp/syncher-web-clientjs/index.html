<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>syncher-web-clientjs</title>
<!-- 
<link rel="stylesheet/less" type="text/css" href="../themes/bootstrap/less/bootstrap.less" />
 -->

<link rel="stylesheet/less" type="text/css" href="less/style.less" />
<link rel="stylesheet/less" type="text/css" href="css/knockback-navigators.css" />

<style>
body {
	padding-top: 60px;
	/* 60px to make the container go all the way to the bottom of the topbar */
}
</style>

</head>
<body>
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
                </button>
                <a class="brand" href="#">MaidSyncher</a>
                <div class="nav-collapse collapse">
                    <ul class="nav">
                        <li class="active"><a href="#">Sync logs</a></li>
                    </ul>
                </div>
                <!--/.nav-collapse -->
                <p class="navbar-text pull-right">Last synch at XX XX XX</p>
            </div>
        </div>
    </div>

    <div id="content" class="container-fluid">
        <div id="pleaseWait" style="display: none; height: 100px;">
            <p>
                <b>Processing, please wait</b>
            </p>
        </div>

        <div id="main">
            <h1>Synchronization logs</h1>
            <p>Below are the sortable, and filtarable, logs of all the synchs. Click on a row to get more info about
                each synch</p>

            <p>
                SyncEvents to process: <span data-bind="text: remainingSyncEvents().length"></span>
            </p>

            <p>
                Nr synchronizations: <span data-bind="text: syncLogs().length"></span>
            </p>

            <div id="syncLogs">
                <label class="checkbox"><input type="checkbox" data-bind="checked: hideSyncs"> Hide
                    Syncs without side-effects</label>
                <table class="table table-hover-clickable">
                    <thead>
                        <tr>
                            <th>Date of start</th>
                            <th>Actions</th>
                            <th>Conflicts</th>
                            <th>Warnings</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: syncLogs">
                        <!-- <tr data-bind="css: $data.representationRowClass"> -->
                        <tr
                            data-bind="css: classCss, click: $parent.goToLogDetails, visible: ($parent.hideSyncs() == true && hasItems()) || ($parent.hideSyncs() == false)">
                            <td><span data-bind="html:  friendlyDateTime(SyncStartTime(), true)"> </span> <span
                                class="muted" data-bind="text: '('+ humanFriendlyFromNow(SyncStartTime()) +')'"></span></td>
                            <td data-bind="text: actions().length" />
                            <td data-bind="text: conflicts().length" />
                            <td><span data-bind="text: warnings().length"></span> <!-- ko if: warnings().length > 0 -->
                                <i class="icon-warning-sign"></i> <!-- /ko --></td>
                            <td data-bind="text: Status" />

                        </tr>
                    </tbody>

                </table>

            </div>
        </div>


        <div id="details" class="modal hide fadel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
            aria-hidden="true" data-bind="if: selectedSyncLog">
            <!-- ko with: selectedSyncLog -->
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3>Sync Details</h3>
            </div>
            <div class="modal-body">
                <p>
                    <strong>Start time:</strong> <span data-bind="text: friendlyNamedDateTime(SyncStartTime())"></span>
                </p>
                <div class="alert alert-error alert-overflow" data-bind="visible: shouldShowStackTrace">
                    <button type="button" class="close" data-bind="click: toggleStackTraceCommand">&times;</button>
                    <strong>Failure!</strong> <small class="text-mini" data-bind="text: SerializedStackTrace"></small>
                </div>
                <table class="table-condensed table-bordered-outline">
                    <tbody>
                        <tr>
                            <td><strong>Status:</strong></td>
                            <td><span id="statusModal" data-bind="text: Status, css: statusStyle, click: toggleStackTraceCommand"></span></td>
                        </tr>
                        <tr>
                            <td><strong>GitHub sync time:</strong></td>
                            <td>
                                <!--                                 <span style="cursor: default; padding: 0 0;" class="btn btn-link btn-muted"
                                id="ghSyncTime" data-bind="text: ghSyncTimeDuration() + 's'"></span> --> <span
                                class="popoverStyle" id="ghSyncTime"
                                data-bind="text: ghSyncTimeDuration() + 's', visible: ghSyncTimeDuration() !== undefined"></span>
                            </td>
                            <td><strong>ActiveCollab sync time:</strong></td>
                            <td>
                                <!--  <span style="cursor: default; padding: 0 0;" class="btn btn-link btn-muted"
                                id="acSyncTime" data-bind="text: acSyncTimeDuration() + 's'"></span> --> <span
                                id="acSyncTime"
                                data-bind="text: acSyncTimeDuration() + 's', visible: ghSyncTimeDuration() !== undefined"></span>
                            </td>

                        </tr>
                        <tr>
                            <td><strong>Sync actions:</strong></td>
                            <td><span data-bind="text: NrGeneratedSyncActions"></span></td>
                            <td><strong>Prev. Sync actions:</strong></td>
                            <td><span data-bind="text: NrGeneratedSyncActionsFromRemainingSyncEvents"></span></td>
                        </tr>
                    </tbody>
                </table>
                <p></p>
                <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#actions">Actions <span
                            data-bind="text: '(' + actions().length + ')'"></span></a></li>
                    <li><a href="#warnings" data-toggle="tab">Warnings <span
                            data-bind="text: '(' + warnings().length + ')'"></span></a></li>
                    <li><a href="#conflicts" data-toggle="tab">Conflicts <span
                            data-bind="text: '(' + conflicts().length + ')'"></span></a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="actions">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Start time</th>
                                    <th>Duration</th>
                                    <th>Origin Object</th>
                                    <th>Success</th>
                                </tr>
                            </thead>
                            <tbody data-bind="foreach: actions">
                                <tr data-bind="css: rowClass">
                                    <td data-bind="text: timeOnly(syncStartTime())"></td>
                                    <td class="muted" data-bind="text: duration() + 's'"></td>
                                    <td><a
                                        data-bind="text: trimmedTypeOriginObject, attr: { href: urlOriginObject }"
                                        target="_blank"></a></td>
                                    <td data-bind="html: successIcon"></td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <div class="tab-pane" id="warnings">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody data-bind="foreach: warnings">
                                <tr class="warning">
                                    <td><i class="icon-warning-sign"></i> <span data-bind="text: description"></span></td>
                                </tr>
                            </tbody>
                        </table>


                    </div>
                    <div class="tab-pane" id="conflicts">...</div>
                </div>


            </div>
            <div class="modal-footer">
                <a href="#" class="btn">Close</a>
            </div>
            <!-- /ko -->
        </div>



    </div>
    <!-- /container -->

    <script src="js/libs/less-1.3.3.min.js" type="text/javascript"></script>
    <script src="js/libs/jquery.js" type="text/javascript"></script>
    <!-- <script src="js/libs/jquery.dataTables.min.js" type="text/javascript"></script> -->
    <script src="js/libs/bootstrap.min.js" type="text/javascript"></script>
    <script src="js/libs/knockback-full-stack.js" type="text/javascript"></script>
    <script src="js/libs/backbone-relational.js" type="text/javascript"></script>
    <!-- <script src="js/libs/knockback-sample-transitions-jquery.js" type="text/javascript"></script>
    <script src="js/libs/knockback-page-navigator-panes.js" type="text/javascript"></script> -->
    <script src="js/libs/moment.min.js" type="text/javascript"></script>
    <script src="js/libs/async.js" type="text/javascript"></script>
    <script src="js/libs/spin.min.js" type="text/javascript"></script>
    <script src="js/libs/jquery.blockUI.js" type="text/javascript"></script>
    <script src="js/Models.js" type="text/javascript"></script>
    <script src="js/App.js" type="text/javascript"></script>
</body>
</html>
